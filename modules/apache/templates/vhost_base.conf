<%- if use_ssl then
    port = 443
else
    port = 80
end
-%>

<VirtualHost *:<%= port %>>
<%- if use_ssl then -%>
        SSLEngine on
  <%- if wildcard_sslcert then -%>
        SSLCertificateFile /etc/ssl/wildcard.<%= domain %>.crt
        SSLCertificateKeyFile /etc/ssl/wildcard.<%= domain %>.key
        SSLCACertificateFile /etc/ssl/wildcard.<%= domain %>.pem
        SSLVerifyClient None
  <%- else -%>
        SSLCertificateFile /etc/ssl/apache/<%= real_vhost %>.pem
        SSLCertificateKeyFile /etc/ssl/apache/<%= real_vhost %>.pem
  <%- end -%>
<%- end -%>
        ServerName <%= real_vhost %>
<%- server_aliases.each do |key| -%>
        ServerAlias <%= key %>
<%- end -%>
        DocumentRoot <%= location %>

<%- if enable_public_html -%>
        #TODO add the rest
        UserDir public_html
<%- else -%>
<IfModule mod_userdir.c>
        UserDir disabled
</IfModule>
<%- end -%>
<%- aliases.each_pair do |key,value| -%>
        Alias <%= key %> <%= value %>
<%- end -%>
        <%= content %>

        <Location />
            Allow from all
        </Location>
</VirtualHost>

